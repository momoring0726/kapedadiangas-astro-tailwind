---
// src/layouts/Layout.astro
import '../styles/global.css'; // This imports your styles and theme!

interface Props {
	title: string;
}

const { title } = Astro.props;
---

<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>{title}</title>

		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Roboto:wght@300;400;500&display=swap"
			rel="stylesheet"
		/>
		<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
		/>
	</head>
	<body>
		<div
			class="fixed inset-0 z-[-2] bg-cover bg-center bg-no-repeat"
			style="background-image: url('/img/heroimg.jpg')"
		>
		</div>
		<div class="fixed inset-0 z-[-1] bg-black/60"></div>

		<nav
			id="navbar"
			class="sticky top-0 z-50 py-4 text-white transition-all duration-300"
		>
			<div class="container mx-auto flex items-center justify-between px-4">
				<a href="#" class="font-heading text-3xl">Kape Dadiangas</a>
				<button
					class="navbar-toggler lg:hidden"
					type="button"
					aria-label="Toggle navigation"
				>
					<span class="navbar-toggler-icon"></span>
				</button>
				<ul class="hidden gap-6 lg:flex">
					<li>
						<a
							href="#about"
							class="text-lg font-medium text-white/90 transition-colors hover:text-primary"
							>About</a
						>
					</li>
					<li>
						<a
							href="#menu"
							class="text-lg font-medium text-white/90 transition-colors hover:text-primary"
							>Menu</a
						>
					</li>
					<li>
						<a
							href="#gallery"
							class="text-lg font-medium text-white/90 transition-colors hover:text-primary"
							>Gallery</a
						>
					</li>
					<li>
						<a
							href="#contact"
							class="text-lg font-medium text-white/90 transition-colors hover:text-primary"
							>Contact</a
						>
					</li>
				</ul>
			</div>
		</nav>

		<main>
			<slot />
		</main>

		<footer class="bg-[#111] py-16 text-center text-white">
			<div class="container mx-auto px-4">
				<p class="font-heading text-3xl">Kape Dadiangas</p>
				<div class="my-6 flex justify-center gap-6">
					<a
						href="#"
						class="text-3xl text-white transition-colors hover:text-primary"
						><i class="bi bi-facebook"></i></a
					>
					<a
						href="#"
						class="text-3xl text-white transition-colors hover:text-primary"
						><i class="bi bi-instagram"></i></a
					>
					<a
						href="#"
						class="text-3xl text-white transition-colors hover:text-primary"
						><i class="bi bi-twitter-x"></i></a
					>
				</div>
				<p class="mb-0">Â© 2025 Mark Wyndl Tan 
Divinagracia. All Rights Reserved.</p>
				<p class="mb-0">This is a demo site for portfolio purposes only.</p>
			</div>
		</footer>

		<div id="gallery-modal" class="modal-overlay">
			<button class="modal-close" aria-label="Close">
				<svg
					xmlns="http://www.w3.org/2000/svg"
					viewBox="0 0 24 24"
					fill="none"
					stroke="currentColor"
					stroke-width="2"
					stroke-linecap="round"
					stroke-linejoin="round"
					class="h-8 w-8"
				>
					<line x1="18" y1="6" x2="6" y2="18"></line>
					<line x1="6" y1="6" x2="18" y2="18"></line>
				</svg>
			</button>

			<div class="modal-content">
				<img src="" alt="" class="modal-img" />
				<div id="modal-caption" class="modal-caption"></div>
			</div>
		</div>
		<script>
			// 1. Navbar style change on scroll
			const navbar = document.getElementById('navbar');
if (navbar) {
				window.addEventListener('scroll', () => {
					if (window.scrollY > 50) {
						// This replaces the .scrolled class
						navbar.classList.add('bg-gray-900/80', 'shadow-lg', 'backdrop-blur-md');
					} else {
						navbar.classList.remove('bg-gray-900/80', 'shadow-lg', 'backdrop-blur-md');
					}
				});
}

			// 2. Fade-in animation on scroll
			const observer = new IntersectionObserver(
				(entries) => {
					entries.forEach((entry) => {
						if (entry.isIntersecting) {
							entry.target.classList.add('is-visible');
						}
					});
				},
				{
					threshold: 0.1,
				}
			);
const sectionsToFade = document.querySelectorAll('.fade-in-section');
			sectionsToFade.forEach((section) => {
				observer.observe(section);
			});

			// 3. Gallery Modal Logic (TypeScript-safe)
			const modal = document.getElementById('gallery-modal') as HTMLElement | null;
			const modalImg = modal?.querySelector('.modal-img') as HTMLImageElement | null;
			const modalCaption = modal?.querySelector('#modal-caption') as HTMLElement | null;
			const galleryItems = document.querySelectorAll<HTMLAnchorElement>('.gallery-item');
			const closeBtn = modal?.querySelector('.modal-close') as HTMLButtonElement | null;

			// Check if all essential modal elements exist
			if (modal && modalImg && modalCaption && closeBtn) {
				galleryItems.forEach((item) => {
					item.addEventListener('click', (e) => {
						e.preventDefault();

						// Get href and alt text
						const imgSrc = item.href;
						const imgAlt = item.dataset.alt || '';

						// Set modal content
						modal.style.display = 'flex';
						modalImg.src = imgSrc;
						modalCaption.textContent = imgAlt;
					});
				});

				// Function to close the modal
				function closeModal() {
					if (modal && modalImg && modalCaption) {
						modal.style.display = 'none';
						modalImg.src = '';
						modalCaption.textContent = '';
					}
				}

				// Add click event to close button
				closeBtn.addEventListener('click', closeModal);

				// Add click event to modal overlay (to close when clicking outside the content)
				modal.addEventListener('click', (e) => {
					if (e.target === modal) {
						closeModal();
					}
				});
			}
		</script>
		<style is:global>
			.fade-in-section {
				opacity: 0;
				transform: translateY(20px);
				transition:
					opacity 0.6s ease-out,
					transform 0.6s ease-out;
}
			.fade-in-section.is-visible {
				opacity: 1;
				transform: translateY(0);
			}

			/* ========= START: MODAL STYLES ========= */
			.modal-overlay {
				display: none; /* Hidden by default */
				position: fixed; /* Stay in place */
				z-index: 1000; /* Sit on top */
				left: 0;
				top: 0;
				width: 100%;
				height: 100%;
				overflow: auto; /* Enable scroll if needed */
				background-color: rgba(0, 0, 0, 0.9); /* Black w/ opacity */
				/* Use flex to center the content box */
				align-items: center;
				justify-content: center;
				padding: 1rem;
			}

			.modal-content {
				position: relative;
				margin: auto;
				padding: 1.5rem; /* 24px */
				/* Using your theme's dark color */
				background-color: var(--color-dark, #1a120b);
				/* Using your theme's primary color */
				border: 2px solid var(--color-primary, #c5a880);
				border-radius: 8px;
				width: auto;
				max-width: 900px; /* Adjust this to make the box wider or narrower */
				max-height: 90vh; /* Max height for the modal box */
				overflow-y: auto; /* Add scroll if content is too tall */
				text-align: center;
				box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
			}

			.modal-img {
				display: block;
				width: 100%; /* Image takes full width of modal-content */
				height: auto;
				max-height: 75vh; /* Constrain image height */
				object-fit: contain;
				border-radius: 4px;
				margin: 0 auto;
			}

			/* Modern Close Button (Overlay Position) */
			.modal-close {
				position: absolute;
				top: 2rem; /* 32px from top of viewport */
				right: 2rem; /* 32px from right of viewport */
				background: none;
				border: none;
				padding: 0;
				cursor: pointer;
				color: var(--color-light, #f0e6d6);
				transition:
					color 0.2s ease-in-out,
					transform 0.2s ease-in-out;
				z-index: 1010; /* Ensure it's above all modal content */
				line-height: 1;
			}

			.modal-close:hover {
				color: var(--color-primary, #c5a880); /* Glows with primary color */
				transform: scale(1.1); /* Slight zoom on hover */
			}

			.modal-caption {
				margin-top: 1rem;
				text-align: center;
				/* Using your theme's light color */
				color: var(--color-light, #f0e6d6);
				font-size: 1.1rem;
			}
			/* ========= END: MODAL STYLES ========= */
		</style>
	</body>
</html>