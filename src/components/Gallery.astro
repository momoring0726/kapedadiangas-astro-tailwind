---
// src/components/Gallery.astro
import { galleryData } from '../data.js';
---

<div class="grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3">
	{
		galleryData.map((item) => (
			<a
				href={item.src}
				class="gallery-thumbnail group block overflow-hidden rounded-lg border-2 border-transparent shadow-sm transition-all duration-300 hover:scale-105 hover:border-primary hover:shadow-black/40"
				data-img-src={item.src}
			>
				<img
					src={item.src}
					alt={item.alt}
					class="img-fluid"
					loading="lazy"
				/>
			</a>
		))
	}
</div>

<div
	id="galleryModal"
	class="fixed inset-0 z-[100] flex hidden items-center justify-center bg-black/80 p-4 backdrop-blur-sm"
>
	<div class="relative max-h-full max-w-4xl">
		<img
			id="modalImage"
			src=""
			alt="Gallery Image Preview"
			class="h-auto max-h-[90vh] w-full rounded-lg"
		/>
	</div>
	<button
		id="modalClose"
		type="button"
		class="absolute right-6 top-6 z-[110] text-3xl font-bold text-white opacity-80 transition-opacity hover:opacity-100"
	>
		Ã—
	</button>
</div>

<script>
	const modal = document.getElementById('galleryModal');
	const modalImage = document.getElementById('modalImage') as HTMLImageElement;
	const modalClose = document.getElementById('modalClose');

	function openModal(src: string) {
		if (modalImage) modalImage.src = src;
		if (modal) modal.classList.remove('hidden');
	}

	function closeModal() {
		if (modal) modal.classList.add('hidden');
		if (modalImage) modalImage.src = '';
	}

	const thumbnails = document.querySelectorAll('.gallery-thumbnail');
	thumbnails.forEach((thumb) => {
		thumb.addEventListener('click', (event) => {
			event.preventDefault();
			const imgSrc = thumb.getAttribute('data-img-src');
			if (imgSrc) openModal(imgSrc);
		});
	});

	if (modalClose) modalClose.addEventListener('click', closeModal);
	if (modal) {
		modal.addEventListener('click', (event) => {
			if (event.target === modal) closeModal();
		});
	}
</script>